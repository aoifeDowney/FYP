"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var common_1 = require("@angular/common");
var Kinvey = require("kinvey-nativescript-sdk");
var TransactionsService = /** @class */ (function () {
    function TransactionsService(datePipe) {
        this.datePipe = datePipe;
        this.activeUser = Kinvey.User.getActiveUser();
        this.userData = Kinvey.User.getActiveUser().data;
        this.dataStore = Kinvey.DataStore.collection("Transactions");
    }
    TransactionsService.prototype.save = function (task) {
        return this.dataStore.save(task);
    };
    TransactionsService.prototype.get = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        var fourthQuery = new Kinvey.Query();
        // Sort by descending “entity created time” to put new items on top.
        query.descending("_kmd.ect");
        secondQuery.equalTo('complete', true);
        thirdQuery.equalTo("boughtBy", this.activeUser.username);
        fourthQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery).and(fourthQuery));
    };
    TransactionsService.prototype.getHouseShopPrice = function () {
        var query = new Kinvey.Query();
        query.equalTo('type', 'House Shop');
        return this.dataStore.find(query);
    };
    TransactionsService.prototype.getItemBoughtDate = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        query.equalTo('type', 'House Shop');
        secondQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery));
    };
    TransactionsService.prototype.getRent = function () {
        var query = new Kinvey.Query();
        query.equalTo('type', 'Rent');
        var secondQuery = new Kinvey.Query();
        secondQuery.equalTo('complete', true);
        var thirdQuery = new Kinvey.Query();
        thirdQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery));
    };
    TransactionsService.prototype.getRentForUser = function () {
        var query = new Kinvey.Query();
        query.equalTo('type', 'Rent');
        var secondQuery = new Kinvey.Query();
        secondQuery.equalTo('complete', false);
        var thirdQuery = new Kinvey.Query();
        thirdQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery));
    };
    TransactionsService.prototype.getAllUtilityBills = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        var fourthQuery = new Kinvey.Query();
        query.equalTo('type', 'Utility Bill');
        secondQuery.equalTo('houseName', this.userData["household"]);
        thirdQuery.equalTo('complete', false);
        fourthQuery.equalTo('toPay', this.activeUser.username);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery).and(fourthQuery));
    };
    TransactionsService.prototype.getUtilityBillDue = function () {
        var now = new Date();
        var date = this.datePipe.transform(now, "yyyy-MM-dd");
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        var fourthQuery = new Kinvey.Query();
        var fifthQuery = new Kinvey.Query();
        query.equalTo('type', 'Utility Bill');
        secondQuery.equalTo('houseName', this.userData["household"]);
        thirdQuery.equalTo('complete', false);
        fourthQuery.equalTo('toPay', this.activeUser.username);
        fifthQuery.equalTo('date', date);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery).and(fourthQuery).and(fifthQuery));
    };
    TransactionsService.prototype.getUtilityBill = function () {
        var query = new Kinvey.Query();
        query.equalTo('type', 'Utility Bill');
        var secondQuery = new Kinvey.Query();
        secondQuery.equalTo('complete', true);
        var thirdQuery = new Kinvey.Query();
        thirdQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery));
    };
    TransactionsService.prototype.getUtilityBillNotPaid = function () {
        var query = new Kinvey.Query();
        query.equalTo('type', 'Utility Bill');
        var secondQuery = new Kinvey.Query();
        secondQuery.equalTo('complete', false);
        return this.dataStore.find(query.and(secondQuery));
    };
    TransactionsService.prototype.getHouseShop = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        var fourthQuery = new Kinvey.Query();
        var fifthQuery = new Kinvey.Query();
        query.equalTo('type', 'House Shop');
        secondQuery.equalTo('complete', false);
        thirdQuery.equalTo('bought', true);
        fourthQuery.equalTo('houseName', this.userData["household"]);
        fifthQuery.equalTo("toPay", this.activeUser.username);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery).and(fourthQuery).and(fifthQuery));
    };
    TransactionsService.prototype.getHouseShopPaid = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        var fourthQuery = new Kinvey.Query();
        var fifthQuery = new Kinvey.Query();
        var sixthQuery = new Kinvey.Query();
        query.equalTo('type', 'House Shop');
        secondQuery.equalTo('complete', true);
        thirdQuery.equalTo('bought', true);
        fourthQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery).and(fourthQuery));
    };
    TransactionsService.prototype.getHouseShopPaidName = function (itemName) {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        var fourthQuery = new Kinvey.Query();
        var fifthQuery = new Kinvey.Query();
        var sixthQuery = new Kinvey.Query();
        query.equalTo('type', 'House Shop');
        secondQuery.equalTo('complete', true);
        thirdQuery.equalTo('bought', true);
        fourthQuery.equalTo('houseName', this.userData["household"]);
        fifthQuery.equalTo('name', itemName);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery).and(fourthQuery).and(fifthQuery));
    };
    TransactionsService.prototype.getSuggestedItem = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        var fourthQuery = new Kinvey.Query();
        var fifthQuery = new Kinvey.Query();
        query.equalTo('type', 'House Shop');
        secondQuery.equalTo('complete', false);
        thirdQuery.equalTo('bought', false);
        fourthQuery.equalTo('houseName', this.userData["household"]);
        fifthQuery.equalTo('toPay', this.activeUser.username);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery).and(fourthQuery));
    };
    TransactionsService.prototype.getHouseMembers = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        var thirdQuery = new Kinvey.Query();
        query.equalTo('user', true);
        secondQuery.equalTo('houseName', this.userData["household"]);
        thirdQuery.notEqualTo('userName', this.activeUser.username);
        return this.dataStore.find(query.and(secondQuery).and(thirdQuery));
    };
    TransactionsService.prototype.getHouseMembersBill = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        query.equalTo('user', true);
        secondQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery));
    };
    TransactionsService.prototype.getIcon = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        query.equalTo('userName', this.activeUser.username);
        secondQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery));
    };
    TransactionsService.prototype.getUsersIcon = function () {
        var query = new Kinvey.Query();
        var secondQuery = new Kinvey.Query();
        query.notEqualTo('userName', this.activeUser.username);
        secondQuery.equalTo('houseName', this.userData["household"]);
        return this.dataStore.find(query.and(secondQuery));
    };
    TransactionsService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [common_1.DatePipe])
    ], TransactionsService);
    return TransactionsService;
}());
exports.TransactionsService = TransactionsService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNhY3Rpb25zLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ0cmFuc2FjdGlvbnMuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUEyQztBQUMzQywwQ0FBMkM7QUFDM0MsZ0RBQWtEO0FBR2xEO0lBTUksNkJBQW9CLFFBQWtCO1FBQWxCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFIdEMsZUFBVSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDekMsYUFBUSxHQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsSUFBSSxDQUFDO1FBR3pDLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDakUsQ0FBQztJQUVELGtDQUFJLEdBQUosVUFBSyxJQUFJO1FBQ0wsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQsaUNBQUcsR0FBSDtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLElBQU0sVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3RDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLG9FQUFvRTtRQUNwRSxLQUFLLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzdCLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3RDLFVBQVUsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDekQsV0FBVyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBRTdELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7SUFDeEYsQ0FBQztJQUVELCtDQUFpQixHQUFqQjtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBRXBDLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVELCtDQUFpQixHQUFqQjtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBQ3BDLFdBQVcsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUM3RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUN2RCxDQUFDO0lBRUQscUNBQU8sR0FBUDtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzlCLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3RDLElBQU0sVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3RDLFVBQVUsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUU1RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7SUFDdkUsQ0FBQztJQUVELDRDQUFjLEdBQWQ7UUFDSSxJQUFNLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztRQUM5QixJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QyxXQUFXLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN2QyxJQUFNLFVBQVUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN0QyxVQUFVLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFFNUQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO0lBQ3ZFLENBQUM7SUFHRCxnREFBa0IsR0FBbEI7UUFDSSxJQUFNLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QyxJQUFNLFVBQVUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN0QyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsQ0FBQztRQUN0QyxXQUFXLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDN0QsVUFBVSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdEMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUV2RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3hGLENBQUM7SUFFRCwrQ0FBaUIsR0FBakI7UUFDSSxJQUFJLEdBQUcsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3JCLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBQyxZQUFZLENBQUMsQ0FBQztRQUNyRCxJQUFNLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QyxJQUFNLFVBQVUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN0QyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QyxJQUFNLFVBQVUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN0QyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsQ0FBQztRQUN0QyxXQUFXLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDN0QsVUFBVSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdEMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN2RCxVQUFVLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUdqQyxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUN4RyxDQUFDO0lBRUQsNENBQWMsR0FBZDtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBQ3RDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3RDLElBQU0sVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3RDLFVBQVUsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUU1RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7SUFDdkUsQ0FBQztJQUVELG1EQUFxQixHQUFyQjtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBQ3RDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBRXZDLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3ZELENBQUM7SUFFRCwwQ0FBWSxHQUFaO1FBQ0ksSUFBTSxLQUFLLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDakMsSUFBTSxXQUFXLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdkMsSUFBTSxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdEMsSUFBTSxXQUFXLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdkMsSUFBTSxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdEMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFDcEMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbkMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQzdELFVBQVUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7UUFFdEQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7SUFDeEcsQ0FBQztJQUVELDhDQUFnQixHQUFoQjtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLElBQU0sVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3RDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZDLElBQU0sVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3RDLElBQU0sVUFBVSxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3RDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBQ3BDLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3RDLFVBQVUsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ25DLFdBQVcsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUU3RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3hGLENBQUM7SUFFRCxrREFBb0IsR0FBcEIsVUFBcUIsUUFBZ0I7UUFDakMsSUFBTSxLQUFLLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDakMsSUFBTSxXQUFXLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdkMsSUFBTSxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdEMsSUFBTSxXQUFXLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdkMsSUFBTSxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdEMsSUFBTSxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdEMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFDcEMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDdEMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbkMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQzdELFVBQVUsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBRXJDLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO0lBQ3hHLENBQUM7SUFFRCw4Q0FBZ0IsR0FBaEI7UUFDSSxJQUFNLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QyxJQUFNLFVBQVUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN0QyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QyxJQUFNLFVBQVUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN0QyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxZQUFZLENBQUMsQ0FBQztRQUNwQyxXQUFXLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN2QyxVQUFVLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNwQyxXQUFXLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDN0QsVUFBVSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUV0RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3hGLENBQUM7SUFFRCw2Q0FBZSxHQUFmO1FBQ0ksSUFBTSxLQUFLLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDakMsSUFBTSxXQUFXLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdkMsSUFBTSxVQUFVLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFFdEMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDNUIsV0FBVyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQzdELFVBQVUsQ0FBQyxVQUFVLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7UUFFNUQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO0lBQ3ZFLENBQUM7SUFFRCxpREFBbUIsR0FBbkI7UUFDSSxJQUFNLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUV2QyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM1QixXQUFXLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFFN0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVELHFDQUFPLEdBQVA7UUFDSSxJQUFNLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQyxJQUFNLFdBQVcsR0FBRyxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUV2QyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3BELFdBQVcsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUU3RCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUV2RCxDQUFDO0lBRUQsMENBQVksR0FBWjtRQUNJLElBQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBRXZDLEtBQUssQ0FBQyxVQUFVLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdkQsV0FBVyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBRTdELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3ZELENBQUM7SUEzTlEsbUJBQW1CO1FBRC9CLGlCQUFVLEVBQUU7eUNBT3FCLGlCQUFRO09BTjdCLG1CQUFtQixDQTROL0I7SUFBRCwwQkFBQztDQUFBLEFBNU5ELElBNE5DO0FBNU5ZLGtEQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBEYXRlUGlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCAqIGFzIEtpbnZleSBmcm9tIFwia2ludmV5LW5hdGl2ZXNjcmlwdC1zZGtcIjtcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIFRyYW5zYWN0aW9uc1NlcnZpY2Uge1xyXG5cclxuICAgIHByaXZhdGUgZGF0YVN0b3JlO1xyXG4gICAgYWN0aXZlVXNlciA9IEtpbnZleS5Vc2VyLmdldEFjdGl2ZVVzZXIoKTtcclxuICAgIHVzZXJEYXRhID0g4oCLS2ludmV5LlVzZXIuZ2V0QWN0aXZlVXNlcigpLmRhdGE7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBkYXRlUGlwZTogRGF0ZVBpcGUpIHtcclxuICAgICAgICB0aGlzLmRhdGFTdG9yZSA9IEtpbnZleS5EYXRhU3RvcmUuY29sbGVjdGlvbihcIlRyYW5zYWN0aW9uc1wiKTtcclxuICAgIH1cclxuXHJcbiAgICBzYXZlKHRhc2spIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuc2F2ZSh0YXNrKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQoKSB7XHJcbiAgICAgICAgY29uc3QgcXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3Qgc2Vjb25kUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3QgdGhpcmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCBmb3VydGhRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICAvLyBTb3J0IGJ5IGRlc2NlbmRpbmcg4oCcZW50aXR5IGNyZWF0ZWQgdGltZeKAnSB0byBwdXQgbmV3IGl0ZW1zIG9uIHRvcC5cclxuICAgICAgICBxdWVyeS5kZXNjZW5kaW5nKFwiX2ttZC5lY3RcIik7XHJcbiAgICAgICAgc2Vjb25kUXVlcnkuZXF1YWxUbygnY29tcGxldGUnLCB0cnVlKTtcclxuICAgICAgICB0aGlyZFF1ZXJ5LmVxdWFsVG8oXCJib3VnaHRCeVwiLCB0aGlzLmFjdGl2ZVVzZXIudXNlcm5hbWUpO1xyXG4gICAgICAgIGZvdXJ0aFF1ZXJ5LmVxdWFsVG8oJ2hvdXNlTmFtZScsIHRoaXMudXNlckRhdGFbXCJob3VzZWhvbGRcIl0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuZmluZChxdWVyeS5hbmQoc2Vjb25kUXVlcnkpLmFuZCh0aGlyZFF1ZXJ5KS5hbmQoZm91cnRoUXVlcnkpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRIb3VzZVNob3BQcmljZSgpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBxdWVyeS5lcXVhbFRvKCd0eXBlJywgJ0hvdXNlIFNob3AnKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVN0b3JlLmZpbmQocXVlcnkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEl0ZW1Cb3VnaHREYXRlKCkge1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IHNlY29uZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIHF1ZXJ5LmVxdWFsVG8oJ3R5cGUnLCAnSG91c2UgU2hvcCcpO1xyXG4gICAgICAgIHNlY29uZFF1ZXJ5LmVxdWFsVG8oJ2hvdXNlTmFtZScsIHRoaXMudXNlckRhdGFbXCJob3VzZWhvbGRcIl0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFJlbnQoKSB7XHJcbiAgICAgICAgY29uc3QgcXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgcXVlcnkuZXF1YWxUbygndHlwZScsICdSZW50Jyk7XHJcbiAgICAgICAgY29uc3Qgc2Vjb25kUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgc2Vjb25kUXVlcnkuZXF1YWxUbygnY29tcGxldGUnLCB0cnVlKTtcclxuICAgICAgICBjb25zdCB0aGlyZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIHRoaXJkUXVlcnkuZXF1YWxUbygnaG91c2VOYW1lJywgdGhpcy51c2VyRGF0YVtcImhvdXNlaG9sZFwiXSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkuYW5kKHRoaXJkUXVlcnkpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRSZW50Rm9yVXNlcigpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBxdWVyeS5lcXVhbFRvKCd0eXBlJywgJ1JlbnQnKTtcclxuICAgICAgICBjb25zdCBzZWNvbmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBzZWNvbmRRdWVyeS5lcXVhbFRvKCdjb21wbGV0ZScsIGZhbHNlKTtcclxuICAgICAgICBjb25zdCB0aGlyZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIHRoaXJkUXVlcnkuZXF1YWxUbygnaG91c2VOYW1lJywgdGhpcy51c2VyRGF0YVtcImhvdXNlaG9sZFwiXSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkuYW5kKHRoaXJkUXVlcnkpKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0QWxsVXRpbGl0eUJpbGxzKCkge1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IHNlY29uZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IHRoaXJkUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3QgZm91cnRoUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgcXVlcnkuZXF1YWxUbygndHlwZScsICdVdGlsaXR5IEJpbGwnKTtcclxuICAgICAgICBzZWNvbmRRdWVyeS5lcXVhbFRvKCdob3VzZU5hbWUnLCB0aGlzLnVzZXJEYXRhW1wiaG91c2Vob2xkXCJdKTtcclxuICAgICAgICB0aGlyZFF1ZXJ5LmVxdWFsVG8oJ2NvbXBsZXRlJywgZmFsc2UpO1xyXG4gICAgICAgIGZvdXJ0aFF1ZXJ5LmVxdWFsVG8oJ3RvUGF5JywgdGhpcy5hY3RpdmVVc2VyLnVzZXJuYW1lKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVN0b3JlLmZpbmQocXVlcnkuYW5kKHNlY29uZFF1ZXJ5KS5hbmQodGhpcmRRdWVyeSkuYW5kKGZvdXJ0aFF1ZXJ5KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXRpbGl0eUJpbGxEdWUoKSB7XHJcbiAgICAgICAgbGV0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgbGV0IGRhdGUgPSB0aGlzLmRhdGVQaXBlLnRyYW5zZm9ybShub3csXCJ5eXl5LU1NLWRkXCIpO1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IHNlY29uZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IHRoaXJkUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3QgZm91cnRoUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3QgZmlmdGhRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBxdWVyeS5lcXVhbFRvKCd0eXBlJywgJ1V0aWxpdHkgQmlsbCcpO1xyXG4gICAgICAgIHNlY29uZFF1ZXJ5LmVxdWFsVG8oJ2hvdXNlTmFtZScsIHRoaXMudXNlckRhdGFbXCJob3VzZWhvbGRcIl0pO1xyXG4gICAgICAgIHRoaXJkUXVlcnkuZXF1YWxUbygnY29tcGxldGUnLCBmYWxzZSk7XHJcbiAgICAgICAgZm91cnRoUXVlcnkuZXF1YWxUbygndG9QYXknLCB0aGlzLmFjdGl2ZVVzZXIudXNlcm5hbWUpO1xyXG4gICAgICAgIGZpZnRoUXVlcnkuZXF1YWxUbygnZGF0ZScsIGRhdGUpO1xyXG4gICAgXHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkuYW5kKHRoaXJkUXVlcnkpLmFuZChmb3VydGhRdWVyeSkuYW5kKGZpZnRoUXVlcnkpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVdGlsaXR5QmlsbCgpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBxdWVyeS5lcXVhbFRvKCd0eXBlJywgJ1V0aWxpdHkgQmlsbCcpO1xyXG4gICAgICAgIGNvbnN0IHNlY29uZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIHNlY29uZFF1ZXJ5LmVxdWFsVG8oJ2NvbXBsZXRlJywgdHJ1ZSk7XHJcbiAgICAgICAgY29uc3QgdGhpcmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICB0aGlyZFF1ZXJ5LmVxdWFsVG8oJ2hvdXNlTmFtZScsIHRoaXMudXNlckRhdGFbXCJob3VzZWhvbGRcIl0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuZmluZChxdWVyeS5hbmQoc2Vjb25kUXVlcnkpLmFuZCh0aGlyZFF1ZXJ5KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXRpbGl0eUJpbGxOb3RQYWlkKCkge1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIHF1ZXJ5LmVxdWFsVG8oJ3R5cGUnLCAnVXRpbGl0eSBCaWxsJyk7XHJcbiAgICAgICAgY29uc3Qgc2Vjb25kUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgc2Vjb25kUXVlcnkuZXF1YWxUbygnY29tcGxldGUnLCBmYWxzZSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEhvdXNlU2hvcCgpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCBzZWNvbmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCB0aGlyZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZvdXJ0aFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZpZnRoUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgcXVlcnkuZXF1YWxUbygndHlwZScsICdIb3VzZSBTaG9wJyk7XHJcbiAgICAgICAgc2Vjb25kUXVlcnkuZXF1YWxUbygnY29tcGxldGUnLCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcmRRdWVyeS5lcXVhbFRvKCdib3VnaHQnLCB0cnVlKTtcclxuICAgICAgICBmb3VydGhRdWVyeS5lcXVhbFRvKCdob3VzZU5hbWUnLCB0aGlzLnVzZXJEYXRhW1wiaG91c2Vob2xkXCJdKTtcclxuICAgICAgICBmaWZ0aFF1ZXJ5LmVxdWFsVG8oXCJ0b1BheVwiLCB0aGlzLmFjdGl2ZVVzZXIudXNlcm5hbWUpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuZmluZChxdWVyeS5hbmQoc2Vjb25kUXVlcnkpLmFuZCh0aGlyZFF1ZXJ5KS5hbmQoZm91cnRoUXVlcnkpLmFuZChmaWZ0aFF1ZXJ5KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SG91c2VTaG9wUGFpZCgpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCBzZWNvbmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCB0aGlyZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZvdXJ0aFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZpZnRoUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3Qgc2l4dGhRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBxdWVyeS5lcXVhbFRvKCd0eXBlJywgJ0hvdXNlIFNob3AnKTtcclxuICAgICAgICBzZWNvbmRRdWVyeS5lcXVhbFRvKCdjb21wbGV0ZScsIHRydWUpO1xyXG4gICAgICAgIHRoaXJkUXVlcnkuZXF1YWxUbygnYm91Z2h0JywgdHJ1ZSk7XHJcbiAgICAgICAgZm91cnRoUXVlcnkuZXF1YWxUbygnaG91c2VOYW1lJywgdGhpcy51c2VyRGF0YVtcImhvdXNlaG9sZFwiXSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkuYW5kKHRoaXJkUXVlcnkpLmFuZChmb3VydGhRdWVyeSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEhvdXNlU2hvcFBhaWROYW1lKGl0ZW1OYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCBzZWNvbmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCB0aGlyZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZvdXJ0aFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZpZnRoUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3Qgc2l4dGhRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBxdWVyeS5lcXVhbFRvKCd0eXBlJywgJ0hvdXNlIFNob3AnKTtcclxuICAgICAgICBzZWNvbmRRdWVyeS5lcXVhbFRvKCdjb21wbGV0ZScsIHRydWUpO1xyXG4gICAgICAgIHRoaXJkUXVlcnkuZXF1YWxUbygnYm91Z2h0JywgdHJ1ZSk7XHJcbiAgICAgICAgZm91cnRoUXVlcnkuZXF1YWxUbygnaG91c2VOYW1lJywgdGhpcy51c2VyRGF0YVtcImhvdXNlaG9sZFwiXSk7XHJcbiAgICAgICAgZmlmdGhRdWVyeS5lcXVhbFRvKCduYW1lJywgaXRlbU5hbWUpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuZmluZChxdWVyeS5hbmQoc2Vjb25kUXVlcnkpLmFuZCh0aGlyZFF1ZXJ5KS5hbmQoZm91cnRoUXVlcnkpLmFuZChmaWZ0aFF1ZXJ5KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U3VnZ2VzdGVkSXRlbSgpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCBzZWNvbmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCB0aGlyZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZvdXJ0aFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IGZpZnRoUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgcXVlcnkuZXF1YWxUbygndHlwZScsICdIb3VzZSBTaG9wJyk7XHJcbiAgICAgICAgc2Vjb25kUXVlcnkuZXF1YWxUbygnY29tcGxldGUnLCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcmRRdWVyeS5lcXVhbFRvKCdib3VnaHQnLCBmYWxzZSk7XHJcbiAgICAgICAgZm91cnRoUXVlcnkuZXF1YWxUbygnaG91c2VOYW1lJywgdGhpcy51c2VyRGF0YVtcImhvdXNlaG9sZFwiXSk7XHJcbiAgICAgICAgZmlmdGhRdWVyeS5lcXVhbFRvKCd0b1BheScsIHRoaXMuYWN0aXZlVXNlci51c2VybmFtZSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkuYW5kKHRoaXJkUXVlcnkpLmFuZChmb3VydGhRdWVyeSkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRIb3VzZU1lbWJlcnMoKSB7XHJcbiAgICAgICAgY29uc3QgcXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3Qgc2Vjb25kUXVlcnkgPSBuZXcgS2ludmV5LlF1ZXJ5KCk7XHJcbiAgICAgICAgY29uc3QgdGhpcmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuXHJcbiAgICAgICAgcXVlcnkuZXF1YWxUbygndXNlcicsIHRydWUpO1xyXG4gICAgICAgIHNlY29uZFF1ZXJ5LmVxdWFsVG8oJ2hvdXNlTmFtZScsIHRoaXMudXNlckRhdGFbXCJob3VzZWhvbGRcIl0pO1xyXG4gICAgICAgIHRoaXJkUXVlcnkubm90RXF1YWxUbygndXNlck5hbWUnLCB0aGlzLmFjdGl2ZVVzZXIudXNlcm5hbWUpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuZmluZChxdWVyeS5hbmQoc2Vjb25kUXVlcnkpLmFuZCh0aGlyZFF1ZXJ5KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SG91c2VNZW1iZXJzQmlsbCgpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCBzZWNvbmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuXHJcbiAgICAgICAgcXVlcnkuZXF1YWxUbygndXNlcicsIHRydWUpO1xyXG4gICAgICAgIHNlY29uZFF1ZXJ5LmVxdWFsVG8oJ2hvdXNlTmFtZScsIHRoaXMudXNlckRhdGFbXCJob3VzZWhvbGRcIl0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuZmluZChxdWVyeS5hbmQoc2Vjb25kUXVlcnkpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRJY29uKCkge1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG4gICAgICAgIGNvbnN0IHNlY29uZFF1ZXJ5ID0gbmV3IEtpbnZleS5RdWVyeSgpO1xyXG5cclxuICAgICAgICBxdWVyeS5lcXVhbFRvKCd1c2VyTmFtZScsIHRoaXMuYWN0aXZlVXNlci51c2VybmFtZSk7XHJcbiAgICAgICAgc2Vjb25kUXVlcnkuZXF1YWxUbygnaG91c2VOYW1lJywgdGhpcy51c2VyRGF0YVtcImhvdXNlaG9sZFwiXSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFTdG9yZS5maW5kKHF1ZXJ5LmFuZChzZWNvbmRRdWVyeSkpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJzSWNvbigpIHtcclxuICAgICAgICBjb25zdCBxdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuICAgICAgICBjb25zdCBzZWNvbmRRdWVyeSA9IG5ldyBLaW52ZXkuUXVlcnkoKTtcclxuXHJcbiAgICAgICAgcXVlcnkubm90RXF1YWxUbygndXNlck5hbWUnLCB0aGlzLmFjdGl2ZVVzZXIudXNlcm5hbWUpO1xyXG4gICAgICAgIHNlY29uZFF1ZXJ5LmVxdWFsVG8oJ2hvdXNlTmFtZScsIHRoaXMudXNlckRhdGFbXCJob3VzZWhvbGRcIl0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RvcmUuZmluZChxdWVyeS5hbmQoc2Vjb25kUXVlcnkpKTtcclxuICAgIH1cclxufSJdfQ==