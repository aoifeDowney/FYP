"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var app = require("application");
var color_1 = require("color");
var nativescript_ui_calendar_1 = require("nativescript-ui-calendar");
var calendarModule = require("nativescript-ui-calendar");
var transactions_service_1 = require("../../shared/transactions/transactions.service");
var CalendarComponent = /** @class */ (function () {
    function CalendarComponent(transactionsService) {
        this.transactionsService = transactionsService;
        this.transactions = [];
        this.calendarEvents = [];
        this.payments = [];
        this.dates = [];
        this.date = [];
        this.names = [];
        this.name = [];
    }
    CalendarComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.transactionsService.get().subscribe(function (data) {
            _this.dates.push(data);
            _this.names.push(data);
            for (var i = 0; i < _this.dates.length; i++) {
                _this.date.push(_this.dates[0][i]["date"]);
                _this.name.push(_this.names[0][i]["name"]);
                console.log("NAME: " + _this.name[i]);
            }
            var events = [];
            var startDate;
            var endDate;
            var colors = [new color_1.Color(200, 188, 26, 214), new color_1.Color(220, 255, 109, 130), new color_1.Color(255, 55, 45, 255), new color_1.Color(199, 17, 227, 10), new color_1.Color(255, 255, 54, 3)];
            for (var i = 1; i < _this.name.length; i++) {
                startDate = new Date(_this.date[i]);
                endDate = new Date(_this.date[i]);
                var event_1 = new calendarModule.CalendarEvent(_this.name[i], startDate, endDate, false, colors[2 * 10 % (colors.length - 1)]);
                events.push(event_1);
                if (2 % 3 == 0) {
                    event_1 = new calendarModule.CalendarEvent(_this.name[i], startDate, endDate, true, colors[2 * 5 % (colors.length - 1)]);
                    events.push(event_1);
                }
                _this.calendarEvents = events;
            }
        }, function () {
            alert({
                title: "Transactions",
                message: "An error occurred retrieving your data"
            });
        });
    };
    CalendarComponent.prototype.getItemDetail = function (date) {
        this.itemDate = date;
        return this.itemDate;
    };
    CalendarComponent.prototype.monthViewStyle = function () {
        var monthViewStyle = new nativescript_ui_calendar_1.CalendarMonthViewStyle();
        monthViewStyle.backgroundColor = new color_1.Color('rgb(255, 255, 255)');
        monthViewStyle.selectionShapeColor = new color_1.Color('rgb(0, 0, 0)');
        var todayCellStyle = new nativescript_ui_calendar_1.DayCellStyle();
        todayCellStyle.cellBackgroundColor = new color_1.Color('rgb(198, 182, 251)');
        todayCellStyle.cellTextColor = new color_1.Color('rgb(112, 0, 203)');
        monthViewStyle.todayCellStyle = todayCellStyle;
        var dayCellStyle = new nativescript_ui_calendar_1.DayCellStyle();
        dayCellStyle.cellBackgroundColor = new color_1.Color('rgb(255, 255, 255)');
        dayCellStyle.cellBorderWidth = 1;
        dayCellStyle.cellBorderColor = new color_1.Color('rgb(255, 255, 255)');
        dayCellStyle.cellTextColor = new color_1.Color('rgb(155, 126, 248)');
        monthViewStyle.dayCellStyle = dayCellStyle;
        var weekendCellStyle = new nativescript_ui_calendar_1.DayCellStyle();
        monthViewStyle.weekendCellStyle = weekendCellStyle;
        var selectedCellStyle = new nativescript_ui_calendar_1.DayCellStyle();
        monthViewStyle.selectedDayCellStyle = selectedCellStyle;
        var dayNameCellStyle = new nativescript_ui_calendar_1.CellStyle();
        dayNameCellStyle.cellBackgroundColor = new color_1.Color('rgb(255, 255, 255)');
        dayNameCellStyle.cellBorderWidth = 1;
        dayNameCellStyle.cellBorderColor = new color_1.Color('rgb(255, 255, 255)');
        dayNameCellStyle.cellTextColor = new color_1.Color('rgb(112, 0, 203)');
        monthViewStyle.dayNameCellStyle = dayNameCellStyle;
        var titleCellStyle = new nativescript_ui_calendar_1.DayCellStyle();
        titleCellStyle.cellBackgroundColor = new color_1.Color('rgb(255, 255, 255)');
        titleCellStyle.cellBorderWidth = 1;
        titleCellStyle.cellBorderColor = new color_1.Color('rgb(255, 255, 255)');
        titleCellStyle.cellTextColor = new color_1.Color('rgb(112, 0, 203)');
        monthViewStyle.titleCellStyle = titleCellStyle;
        return monthViewStyle;
    };
    CalendarComponent.prototype.onDrawerButtonTap = function () {
        var sideDrawer = app.getRootView();
        sideDrawer.showDrawer();
    };
    CalendarComponent = __decorate([
        core_1.Component({
            selector: "gr-calendar",
            templateUrl: "./calendar.component.html",
            styleUrls: ["./calendar.component.css"],
            providers: [transactions_service_1.TransactionsService]
        }),
        __metadata("design:paramtypes", [transactions_service_1.TransactionsService])
    ], CalendarComponent);
    return CalendarComponent;
}());
exports.CalendarComponent = CalendarComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2FsZW5kYXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQXlEO0FBQ3pELGlDQUFtQztBQUVuQywrQkFBOEI7QUFDOUIscUVBWWtDO0FBRWxDLHlEQUEyRDtBQUczRCx1RkFBcUY7QUFRckY7SUFZSSwyQkFBb0IsbUJBQXdDO1FBQXhDLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFSNUQsaUJBQVksR0FBRyxFQUFFLENBQUM7UUFDbEIsbUJBQWMsR0FBRyxFQUFFLENBQUM7UUFDcEIsYUFBUSxHQUFHLEVBQUUsQ0FBQztRQUNkLFVBQUssR0FBRyxFQUFFLENBQUM7UUFDWCxTQUFJLEdBQUcsRUFBRSxDQUFDO1FBQ1YsVUFBSyxHQUFHLEVBQUUsQ0FBQztRQUNYLFNBQUksR0FBRyxFQUFFLENBQUM7SUFFcUQsQ0FBQztJQUVoRSxvQ0FBUSxHQUFSO1FBQUEsaUJBOEJDO1FBN0JHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsVUFBQyxJQUFJO1lBQzFDLEtBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3RCLEtBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3RCLEtBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDdkMsS0FBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO2dCQUN6QyxLQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7Z0JBQzFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxHQUFHLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUN2QztZQUNELElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztZQUNoQixJQUFJLFNBQVMsQ0FBQztZQUNkLElBQUksT0FBTyxDQUFDO1lBQ1osSUFBSSxNQUFNLEdBQUcsQ0FBQyxJQUFJLGFBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRSxJQUFJLGFBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRSxJQUFJLGFBQUssQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRSxJQUFJLGFBQUssQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLGFBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pLLEtBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDdEMsU0FBUyxHQUFHLElBQUksSUFBSSxDQUFDLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbkMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDakMsSUFBSSxPQUFLLEdBQUcsSUFBSSxjQUFjLENBQUMsYUFBYSxDQUFDLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDNUgsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFLLENBQUMsQ0FBQztnQkFDbkIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTtvQkFDWixPQUFLLEdBQUcsSUFBSSxjQUFjLENBQUMsYUFBYSxDQUFDLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdEgsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFLLENBQUMsQ0FBQztpQkFDdEI7Z0JBQ0wsS0FBSSxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUM7YUFDN0I7UUFDSixDQUFDLEVBQUU7WUFDQyxLQUFLLENBQUM7Z0JBQ0YsS0FBSyxFQUFFLGNBQWM7Z0JBQ3JCLE9BQU8sRUFBRSx3Q0FBd0M7YUFDcEQsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQseUNBQWEsR0FBYixVQUFjLElBQVk7UUFDdEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDckIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDO0lBQ3pCLENBQUM7SUFFRCwwQ0FBYyxHQUFkO1FBQ0ksSUFBTSxjQUFjLEdBQUcsSUFBSSxpREFBc0IsRUFBRSxDQUFDO1FBQ3BELGNBQWMsQ0FBQyxlQUFlLEdBQUcsSUFBSSxhQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUNqRSxjQUFjLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxhQUFLLENBQUMsY0FBYyxDQUFDLENBQUM7UUFFL0QsSUFBTSxjQUFjLEdBQUcsSUFBSSx1Q0FBWSxFQUFFLENBQUM7UUFDMUMsY0FBYyxDQUFDLG1CQUFtQixHQUFHLElBQUksYUFBSyxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDckUsY0FBYyxDQUFDLGFBQWEsR0FBRyxJQUFJLGFBQUssQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQzdELGNBQWMsQ0FBQyxjQUFjLEdBQUcsY0FBYyxDQUFDO1FBRS9DLElBQU0sWUFBWSxHQUFHLElBQUksdUNBQVksRUFBRSxDQUFDO1FBQ3hDLFlBQVksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLGFBQUssQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBQ25FLFlBQVksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxDQUFDO1FBQ2pDLFlBQVksQ0FBQyxlQUFlLEdBQUcsSUFBSSxhQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUMvRCxZQUFZLENBQUMsYUFBYSxHQUFHLElBQUksYUFBSyxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFFN0QsY0FBYyxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7UUFFM0MsSUFBTSxnQkFBZ0IsR0FBRyxJQUFJLHVDQUFZLEVBQUUsQ0FBQztRQUM1QyxjQUFjLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7UUFFbkQsSUFBTSxpQkFBaUIsR0FBRyxJQUFJLHVDQUFZLEVBQUUsQ0FBQztRQUM3QyxjQUFjLENBQUMsb0JBQW9CLEdBQUcsaUJBQWlCLENBQUM7UUFFeEQsSUFBTSxnQkFBZ0IsR0FBRyxJQUFJLG9DQUFTLEVBQUUsQ0FBQztRQUN6QyxnQkFBZ0IsQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLGFBQUssQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBQ3ZFLGdCQUFnQixDQUFDLGVBQWUsR0FBRyxDQUFDLENBQUM7UUFDckMsZ0JBQWdCLENBQUMsZUFBZSxHQUFHLElBQUksYUFBSyxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDbkUsZ0JBQWdCLENBQUMsYUFBYSxHQUFHLElBQUksYUFBSyxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDL0QsY0FBYyxDQUFDLGdCQUFnQixHQUFHLGdCQUFnQixDQUFDO1FBRW5ELElBQU0sY0FBYyxHQUFHLElBQUksdUNBQVksRUFBRSxDQUFDO1FBQzFDLGNBQWMsQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLGFBQUssQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBQ3JFLGNBQWMsQ0FBQyxlQUFlLEdBQUcsQ0FBQyxDQUFDO1FBQ25DLGNBQWMsQ0FBQyxlQUFlLEdBQUcsSUFBSSxhQUFLLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUNqRSxjQUFjLENBQUMsYUFBYSxHQUFHLElBQUksYUFBSyxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDN0QsY0FBYyxDQUFDLGNBQWMsR0FBRyxjQUFjLENBQUM7UUFFL0MsT0FBTyxjQUFjLENBQUM7SUFDMUIsQ0FBQztJQUVELDZDQUFpQixHQUFqQjtRQUNJLElBQU0sVUFBVSxHQUFrQixHQUFHLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDcEQsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUEvRlEsaUJBQWlCO1FBTjdCLGdCQUFTLENBQUM7WUFDUCxRQUFRLEVBQUUsYUFBYTtZQUN2QixXQUFXLEVBQUUsMkJBQTJCO1lBQ3hDLFNBQVMsRUFBRSxDQUFDLDBCQUEwQixDQUFDO1lBQ3ZDLFNBQVMsRUFBRSxDQUFDLDBDQUFtQixDQUFDO1NBQ25DLENBQUM7eUNBYTJDLDBDQUFtQjtPQVpuRCxpQkFBaUIsQ0FnRzdCO0lBQUQsd0JBQUM7Q0FBQSxBQWhHRCxJQWdHQztBQWhHWSw4Q0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgKiBhcyBhcHAgZnJvbSBcImFwcGxpY2F0aW9uXCI7XHJcbmltcG9ydCB7IFJhZFNpZGVEcmF3ZXIgfSBmcm9tIFwibmF0aXZlc2NyaXB0LXVpLXNpZGVkcmF3ZXJcIjtcclxuaW1wb3J0IHsgQ29sb3IgfSBmcm9tIFwiY29sb3JcIjtcclxuaW1wb3J0IHtcclxuICAgIEFsbERheUV2ZW50c1ZpZXdTdHlsZSxcclxuICAgIENhbGVuZGFyTW9udGhWaWV3U3R5bGUsXHJcbiAgICBDYWxlbmRhcldlZWtWaWV3U3R5bGUsXHJcbiAgICBDYWxlbmRhclllYXJWaWV3U3R5bGUsXHJcbiAgICBDYWxlbmRhck1vbnRoTmFtZXNWaWV3U3R5bGUsXHJcbiAgICBDYWxlbmRhclZpZXdNb2RlLFxyXG4gICAgQ2FsZW5kYXJEYXlWaWV3U3R5bGUsXHJcbiAgICBDZWxsU3R5bGUsXHJcbiAgICBEYXlDZWxsU3R5bGUsXHJcbiAgICBEYXlFdmVudHNWaWV3U3R5bGUsXHJcbiAgICBNb250aENlbGxTdHlsZVxyXG59IGZyb20gXCJuYXRpdmVzY3JpcHQtdWktY2FsZW5kYXJcIjtcclxuXHJcbmltcG9ydCAqIGFzIGNhbGVuZGFyTW9kdWxlIGZyb20gXCJuYXRpdmVzY3JpcHQtdWktY2FsZW5kYXJcIjtcclxuXHJcblxyXG5pbXBvcnQgeyBUcmFuc2FjdGlvbnNTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL3NoYXJlZC90cmFuc2FjdGlvbnMvdHJhbnNhY3Rpb25zLnNlcnZpY2VcIjtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6IFwiZ3ItY2FsZW5kYXJcIixcclxuICAgIHRlbXBsYXRlVXJsOiBcIi4vY2FsZW5kYXIuY29tcG9uZW50Lmh0bWxcIixcclxuICAgIHN0eWxlVXJsczogW1wiLi9jYWxlbmRhci5jb21wb25lbnQuY3NzXCJdLFxyXG4gICAgcHJvdmlkZXJzOiBbVHJhbnNhY3Rpb25zU2VydmljZV1cclxufSlcclxuZXhwb3J0IGNsYXNzIENhbGVuZGFyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICBpdGVtRGF0ZTogc3RyaW5nO1xyXG5cclxuICAgIHRyYW5zYWN0aW9ucyA9IFtdO1xyXG4gICAgY2FsZW5kYXJFdmVudHMgPSBbXTtcclxuICAgIHBheW1lbnRzID0gW107XHJcbiAgICBkYXRlcyA9IFtdO1xyXG4gICAgZGF0ZSA9IFtdO1xyXG4gICAgbmFtZXMgPSBbXTtcclxuICAgIG5hbWUgPSBbXTtcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0cmFuc2FjdGlvbnNTZXJ2aWNlOiBUcmFuc2FjdGlvbnNTZXJ2aWNlKSB7fVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMudHJhbnNhY3Rpb25zU2VydmljZS5nZXQoKS5zdWJzY3JpYmUoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kYXRlcy5wdXNoKGRhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLm5hbWVzLnB1c2goZGF0YSk7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGUucHVzaCh0aGlzLmRhdGVzWzBdW2ldW1wiZGF0ZVwiXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUucHVzaCh0aGlzLm5hbWVzWzBdW2ldW1wibmFtZVwiXSk7XHJcbiAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTkFNRTogXCIgKyB0aGlzLm5hbWVbaV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBldmVudHMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHN0YXJ0RGF0ZTtcclxuICAgICAgICAgICAgbGV0IGVuZERhdGU7XHJcbiAgICAgICAgICAgIGxldCBjb2xvcnMgPSBbbmV3IENvbG9yKDIwMCwgMTg4LCAyNiwgMjE0KSwgbmV3IENvbG9yKDIyMCwgMjU1LCAxMDksIDEzMCksIG5ldyBDb2xvcigyNTUsIDU1LCA0NSwgMjU1KSwgbmV3IENvbG9yKDE5OSwgMTcsIDIyNywgMTApLCBuZXcgQ29sb3IoMjU1LCAyNTUsIDU0LCAzKV07XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDE7IGkgPCB0aGlzLm5hbWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHRoaXMuZGF0ZVtpXSk7XHJcbiAgICAgICAgICAgICAgICBlbmREYXRlID0gbmV3IERhdGUodGhpcy5kYXRlW2ldKTtcclxuICAgICAgICAgICAgICAgIGxldCBldmVudCA9IG5ldyBjYWxlbmRhck1vZHVsZS5DYWxlbmRhckV2ZW50KHRoaXMubmFtZVtpXSwgc3RhcnREYXRlLCBlbmREYXRlLCBmYWxzZSwgY29sb3JzWzIgKiAxMCAlIChjb2xvcnMubGVuZ3RoIC0gMSldKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50cy5wdXNoKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIGlmICgyICUgMyA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQgPSBuZXcgY2FsZW5kYXJNb2R1bGUuQ2FsZW5kYXJFdmVudCh0aGlzLm5hbWVbaV0sIHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgdHJ1ZSwgY29sb3JzWzIgKiA1ICUgKGNvbG9ycy5sZW5ndGggLSAxKV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50cy5wdXNoKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckV2ZW50cyA9IGV2ZW50cztcclxuICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgICAgICBhbGVydCh7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJUcmFuc2FjdGlvbnNcIixcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiQW4gZXJyb3Igb2NjdXJyZWQgcmV0cmlldmluZyB5b3VyIGRhdGFcIlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRJdGVtRGV0YWlsKGRhdGU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuaXRlbURhdGUgPSBkYXRlO1xyXG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1EYXRlO1xyXG4gICAgfVxyXG5cclxuICAgIG1vbnRoVmlld1N0eWxlKCkge1xyXG4gICAgICAgIGNvbnN0IG1vbnRoVmlld1N0eWxlID0gbmV3IENhbGVuZGFyTW9udGhWaWV3U3R5bGUoKTtcclxuICAgICAgICBtb250aFZpZXdTdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBuZXcgQ29sb3IoJ3JnYigyNTUsIDI1NSwgMjU1KScpO1xyXG4gICAgICAgIG1vbnRoVmlld1N0eWxlLnNlbGVjdGlvblNoYXBlQ29sb3IgPSBuZXcgQ29sb3IoJ3JnYigwLCAwLCAwKScpO1xyXG5cclxuICAgICAgICBjb25zdCB0b2RheUNlbGxTdHlsZSA9IG5ldyBEYXlDZWxsU3R5bGUoKTtcclxuICAgICAgICB0b2RheUNlbGxTdHlsZS5jZWxsQmFja2dyb3VuZENvbG9yID0gbmV3IENvbG9yKCdyZ2IoMTk4LCAxODIsIDI1MSknKTtcclxuICAgICAgICB0b2RheUNlbGxTdHlsZS5jZWxsVGV4dENvbG9yID0gbmV3IENvbG9yKCdyZ2IoMTEyLCAwLCAyMDMpJyk7XHJcbiAgICAgICAgbW9udGhWaWV3U3R5bGUudG9kYXlDZWxsU3R5bGUgPSB0b2RheUNlbGxTdHlsZTtcclxuXHJcbiAgICAgICAgY29uc3QgZGF5Q2VsbFN0eWxlID0gbmV3IERheUNlbGxTdHlsZSgpO1xyXG4gICAgICAgIGRheUNlbGxTdHlsZS5jZWxsQmFja2dyb3VuZENvbG9yID0gbmV3IENvbG9yKCdyZ2IoMjU1LCAyNTUsIDI1NSknKTtcclxuICAgICAgICBkYXlDZWxsU3R5bGUuY2VsbEJvcmRlcldpZHRoID0gMTtcclxuICAgICAgICBkYXlDZWxsU3R5bGUuY2VsbEJvcmRlckNvbG9yID0gbmV3IENvbG9yKCdyZ2IoMjU1LCAyNTUsIDI1NSknKTtcclxuICAgICAgICBkYXlDZWxsU3R5bGUuY2VsbFRleHRDb2xvciA9IG5ldyBDb2xvcigncmdiKDE1NSwgMTI2LCAyNDgpJyk7XHJcblxyXG4gICAgICAgIG1vbnRoVmlld1N0eWxlLmRheUNlbGxTdHlsZSA9IGRheUNlbGxTdHlsZTtcclxuXHJcbiAgICAgICAgY29uc3Qgd2Vla2VuZENlbGxTdHlsZSA9IG5ldyBEYXlDZWxsU3R5bGUoKTtcclxuICAgICAgICBtb250aFZpZXdTdHlsZS53ZWVrZW5kQ2VsbFN0eWxlID0gd2Vla2VuZENlbGxTdHlsZTtcclxuXHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRDZWxsU3R5bGUgPSBuZXcgRGF5Q2VsbFN0eWxlKCk7XHJcbiAgICAgICAgbW9udGhWaWV3U3R5bGUuc2VsZWN0ZWREYXlDZWxsU3R5bGUgPSBzZWxlY3RlZENlbGxTdHlsZTtcclxuXHJcbiAgICAgICAgY29uc3QgZGF5TmFtZUNlbGxTdHlsZSA9IG5ldyBDZWxsU3R5bGUoKTtcclxuICAgICAgICBkYXlOYW1lQ2VsbFN0eWxlLmNlbGxCYWNrZ3JvdW5kQ29sb3IgPSBuZXcgQ29sb3IoJ3JnYigyNTUsIDI1NSwgMjU1KScpO1xyXG4gICAgICAgIGRheU5hbWVDZWxsU3R5bGUuY2VsbEJvcmRlcldpZHRoID0gMTtcclxuICAgICAgICBkYXlOYW1lQ2VsbFN0eWxlLmNlbGxCb3JkZXJDb2xvciA9IG5ldyBDb2xvcigncmdiKDI1NSwgMjU1LCAyNTUpJyk7XHJcbiAgICAgICAgZGF5TmFtZUNlbGxTdHlsZS5jZWxsVGV4dENvbG9yID0gbmV3IENvbG9yKCdyZ2IoMTEyLCAwLCAyMDMpJyk7XHJcbiAgICAgICAgbW9udGhWaWV3U3R5bGUuZGF5TmFtZUNlbGxTdHlsZSA9IGRheU5hbWVDZWxsU3R5bGU7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpdGxlQ2VsbFN0eWxlID0gbmV3IERheUNlbGxTdHlsZSgpO1xyXG4gICAgICAgIHRpdGxlQ2VsbFN0eWxlLmNlbGxCYWNrZ3JvdW5kQ29sb3IgPSBuZXcgQ29sb3IoJ3JnYigyNTUsIDI1NSwgMjU1KScpO1xyXG4gICAgICAgIHRpdGxlQ2VsbFN0eWxlLmNlbGxCb3JkZXJXaWR0aCA9IDE7XHJcbiAgICAgICAgdGl0bGVDZWxsU3R5bGUuY2VsbEJvcmRlckNvbG9yID0gbmV3IENvbG9yKCdyZ2IoMjU1LCAyNTUsIDI1NSknKTtcclxuICAgICAgICB0aXRsZUNlbGxTdHlsZS5jZWxsVGV4dENvbG9yID0gbmV3IENvbG9yKCdyZ2IoMTEyLCAwLCAyMDMpJyk7XHJcbiAgICAgICAgbW9udGhWaWV3U3R5bGUudGl0bGVDZWxsU3R5bGUgPSB0aXRsZUNlbGxTdHlsZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1vbnRoVmlld1N0eWxlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRHJhd2VyQnV0dG9uVGFwKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHNpZGVEcmF3ZXIgPSA8UmFkU2lkZURyYXdlcj5hcHAuZ2V0Um9vdFZpZXcoKTtcclxuICAgICAgICBzaWRlRHJhd2VyLnNob3dEcmF3ZXIoKTtcclxuICAgIH1cclxufSJdfQ==